
# 2016-07-16
#DOCUMENT_IDS=("1YHGlcqnyXpwxLVwhftl0sVbEO0QP-_xF" "18fPUfmPSL3M5lbA76QhiNGIzdAHm5yjS" "1gMGpdD95JSzBHIza_lj3f4EvoMDKZ2zZ" "1u4dp_TGxxcjvIRZ2KlJJIAN6hsftFvHT" "1mJL9xFhN6Qcl6V3kOkLQZioiYvo-hLPH" "15dorDHIU1deOsvz7_Gftp9lCeOhTv4lO" "1PLihGzpgCWv7niAWteBQdVW3o5zrVlzn" "1KlSJL8x4y0tvS0UpimgTkiQ2xp6gtP8I" "1ABALsgTLCrxtB9ENNmTErpyZb9tbi3AF" "1zAgmXYgzIAnXVXVJt2Zl9hUBr_MWC4Cd" "1EAu6uPl2EBYHx65BGFdOuU2fFhZw-3mC" "19b-0MOu95eimE3shZPlKPeDcwYgkamH4")

# 2018-07-16
#DOCUMENT_IDS=("1kXGHW6CM2P6dKKYO44Sq26LhtVnrosbr" "1wzUzSmMV_SVGs9tfrxYAm9wEef8OmNDh" "1o2eAqpSs_6Sa4ItY-a1wp_5lVwtIC9K_" "1L-4UsCrPjqZ1CQfNfhOnGAJh8uMBdLhj" "1TPamt9cB0b6to0COIADDpzooME90Krns" "1djuMEJ5N7qNt52pIGX_rzU4gHzuh3da1" "14Zdlsg3c61Gjg4YbwB27lJiP8USmJhXz" "19oMpn_4zbAD-b1kfcfU2EqDlOSmehOwG" "12CP5HFb6aTf5makt_nAylGIuTyvn8Cr0" "1fjojFowriteUSuRjl7jDHCZoJvhTd_gF" "15YlzncAruTd2xudjpU6nEAYUaVjvKZrk" "1ofXMjlclJCTulFM7IDL0MWUhVBC7EAjP")

#2018-07-16 r2 (eastern region)
#DOCUMENT_IDS=("1rLx_ZI7hNUaDcE6pLYBxrcAWlz3upddo" "16NRNY8L0N9m7MWlWG20xT5OZfxzaz4oo" "1TchOLzks_qG2hwYyb542Z1su-kBpFAEi" "1PaZscaO2Nj-zSN1JDCzm-joCqe8-7dBb" "1nV3UbB09JcpWpRZuIqH57DuBQwQ3M5eE" "1svfwJKAiwkh4uzt6TtV60TF1VpbS9wLp" "18H_4mHXJvx9Rq04E1pjBQYSN2BBqPmiK" "1ZGogxAMjOZgV1ut4A9P0TCICnUz5kkPm" "1dsEuE398ljd1tV94ze4whGMpCsWfxK4g")

# 2019-07-16
# DOCUMENT_IDS=("1nqtuK0hHDERfiH0L1GOXe7BhAotfJ-cc" "1_7jBnT8vri6rHx91R1b6oNYnq5fYVHAV" "1vfsZSHfX_EpBM55UMp-hN7s6HkRdXw4P" "1t4Lq8Fuq964hdhVDGVH5-_MPa3OgjdBT" "1VB9RUh6DYvOvjtsVEHJ-UO5CpeNM8s4o" "1yMoInjSNDmD66iRSm419h00qz9RWyvIS" "1jJHLD7rtevn3EmliahGLxQWSi0N3wl9d" "1G6oNl_APfedATQMT1x0eS4q4oxmT-U03" "1XSZ-xgb5sKd9xMkvOlanygevdXzjpP6g" "1k_ddPUusw71RZWd22umSEDsxF7YzTDEo" "14_0WeIiVTEtapBxAjLfoSdleyHSVe4Wo" "1qDFwxgh6M6BVAyPoll_QgxTOA7-GSihq" "1geHz1-7rlMVq3Is4VY6mmu6PoCRLmqGz" "1_s3AgBeatJkmH5GyvwAvwxt63Y6xwxJf" "1yKap_GrBArTmtQ3By458GdZxxcK-pibP")

#DOCUMENT_IDS=("1aQL4cv020wkchzS7WlHb4XfI4c9j9Do3" "1fO6F4fdCxtAYDnnqV0kQll3eofGNDcaz")

# 
# 2018-08-01
# DOCUMENT_IDS=("1rMAm92Ln84As26BT8fdy_Xb7YV-YXRdU" "1mGcruZV4VcoJPpWQ1456TZ3rUDDLUHJP" "1fCFB9NtwvcmU8F74rbvqf5HIyS6uiKrp" "1xhXT5GmwfwdZWZN48i0MnLZAtQlQQ7LH" "1d0DX7A3nGv905CsNS-xYlGXHo64nGdJz" "1tYsp4aVW1bLD3gvwMdRxMG_xW2kdasjw" "1r6Nmub8noHeFkeW1oyo8OIrg-acsl3rS" "1Z7oac_pU8VGD7lm1Pom-GznGUClm14JL" "1VpFJNXfSDI0jtmDS-Kcylr3j-_2PKDvh" "1Nw25X12ooAs65icUQX-zdO38d5k8VGSF" "1_4cXBS0JlIyKbZpgAzb2eyh8Qg4X9JZj" "11xgW274YggdVRow7E4igDJV3WSAjoESF" "1XQM20iaq4YzT8sZNOmZjeTLSK0fABfIM" "11lVQ5IsjhH8fccKiTd-qMi1EBE-VX51g" "1qrXZbHTSsaf6SW7MEQzfsOm80dNLS7fc" "1VAsl5NzYUaCRYqcnEA4mDC06KM_MmkBm" "1tgUMtypQfVvY_E29ZlmytLg7uFtK_E2b" "1A3U0bc88Y5M8H7d-BjrY1pRaKiS9I4Xs" "1EUHTVTuiYuR5mEQhfqqchXoqfSFjXX5S" "1f4_rY9IqSWShlUPF5__unQKpFqoqVrB6" "1BdVH511o5Tmt5lK4kCt1GzPN_PscCs93")

DOWNLOAD_FOLDER="/mnt/beegfs/bulk/mirror/jyf6/datasets/LandsatReflectance/2016-08-01"


mkdir ./tmp
mkdir ${DOWNLOAD_FOLDER}

for i in ${!DOCUMENT_IDS[@]}; do
  x=$((${i} / 7))
  y=$((${i} % 7))
  FINAL_DOWNLOADED_FILENAME="${DOWNLOAD_FOLDER}/corn_belt_reflectance_2016-08-01_box_${x}_${y}.tif"
  curl -sc ./tmp/cookie "https://drive.google.com/uc?export=download&id=${DOCUMENT_IDS[${i}]}" > /dev/null
  code="$(awk '/_warning_/ {print $NF}' ./tmp/cookie)"  
  curl -Lb ./tmp/cookie "https://drive.google.com/uc?export=download&confirm=${code}&id=${DOCUMENT_IDS[${i}]}" -o ${FINAL_DOWNLOADED_FILENAME}

  #wget --load-cookies /tmp/cookies.txt "https://docs.google.com/uc?export=download&confirm=$(wget --quiet --save-cookies /tmp/cookies.txt --keep-session-cookies --no-check-certificate 'https://docs.google.com/uc?export=download&id=${DOCUMENT_IDS[${i}]}' -O- | sed -rn 's/.*confirm=([0-9A-Za-z_]+).*/\1\n/p')&id=${DOCUMENT_IDS[${i}]}" -O ${FINAL_DOWNLOADED_FILENAME} && rm -rf /tmp/cookies.txt
  #curl -c ./tmp/cookies "https://drive.google.com/uc?export=download&id=${DOCUMENT_IDS[${i}]}" > "./tmp/intermezzo_${i}"
  #curl -L -b ./tmp/cookies "https://drive.google.com$(cat ./tmp/intermezzo_${i} | grep -Po 'uc-download-link" [^>]* href="\K[^"]*' | sed 's/\&amp;/\&/g')" > ${FINAL_DOWNLOADED_FILENAME}
done
